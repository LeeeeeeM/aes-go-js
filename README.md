# AES 加解密接口测试

这个项目演示了一个完整的AES加密解密接口测试流程：前端加密 → 后端解密+重新加密 → 前端解密。

## 技术栈

- **前端**: Vite + React + TypeScript + crypto-js
- **后端**: Go + crypto/aes
- **通信**: HTTP (适合HTTP域名环境，无需HTTPS)

## 为什么不使用 window.crypto.subtle

`window.crypto.subtle` API只在HTTPS或localhost环境下可用，在普通的HTTP域名下无法使用。因此我们使用crypto-js库来实现AES加密，它可以在任何环境下工作。

## 项目结构

```
├── frontend/          # React前端项目
│   ├── src/
│   │   ├── utils/aes.ts     # 前端AES加密工具
│   │   ├── services/api.ts  # API服务
│   │   └── App.tsx          # 主应用组件
├── backend/           # Go后端项目
│   └── main.go        # 后端服务和AES实现
└── README.md
```

## 运行项目

### 1. 启动后端服务

**方式1：使用 air 热重载（推荐）**
```bash
cd backend
./start-backend.sh
```
后端服务将在 `http://localhost:9091` 启动，支持代码热重载。

**方式2：直接运行**
```bash
cd backend
go run main.go -port 9091
```
后端服务将在 `http://localhost:9091` 启动。

### 2. 启动前端项目

```bash
cd frontend
npm install
npm run dev
```

前端将在 `http://localhost:5173` 启动。

### 3. 访问测试页面

打开浏览器访问 `http://localhost:5173` 即可进行AES加密解密接口测试。

**注意**: 后端现在运行在端口 9091，前端已自动配置为连接到此端口。

### 4. 使用说明

1. **输入测试内容**：在第一个输入框中输入要测试的明文内容
2. **设置密钥**：
   - 手动输入：直接在密钥输入框中输入
   - 随机生成：点击"生成随机密钥"按钮自动生成32字符随机密钥
3. **发送测试**：点击"发送测试"按钮开始完整的测试流程
4. **查看结果**：在结果区域查看最终解密后的内容（应与原始输入一致）
5. **清除数据**：点击"清除"按钮清空所有输入和结果

## 功能特性

- ✅ **完整接口测试流程**：前端加密 → 后端解密+重新加密 → 前端解密
- ✅ **动态密钥支持**：支持自定义密钥和随机密钥生成
- ✅ **前后端兼容**：使用相同的AES-CBC-PKCS7算法
- ✅ **HTTP环境友好**：不依赖`window.crypto.subtle`，适合任何HTTP域名
- ✅ **实时验证**：验证整个加解密流程的正确性
- ✅ **现代UI**：响应式设计，支持移动端

## AES配置

- **加密模式**: CBC
- **填充方式**: PKCS7
- **密钥**: `your-secret-key-32-characters-long!` (32字符)
- **输出格式**: Base64

## API接口

### POST /api/process
完整的加解密测试接口

接收前端加密的内容和密钥，后端解密后再重新加密返回

**端点**: `http://localhost:9091/api/process`

请求:
```json
{
  "encryptedText": "前端加密后的Base64字符串",
  "key": "AES密钥"
}
```

响应:
```json
{
  "processedText": "后端重新加密后的Base64字符串"
}
```

### 测试流程
1. 前端生成或输入密钥
2. 前端用密钥加密明文
3. 发送加密内容和密钥给后端
4. 后端用密钥解密内容
5. 后端用密钥重新加密解密后的内容
6. 返回新的加密内容给前端
7. 前端用密钥解密后端返回的内容
8. 验证结果与原始明文一致

## 测试验证

项目包含一个独立的测试脚本 `test-flow.js`，用于验证AES加解密流程：

```bash
node test-flow.js
```

测试脚本会：
- 生成32字符随机密钥
- 模拟完整的加密解密流程
- 验证前后端算法兼容性
- 输出详细的测试结果

## 安全注意事项

⚠️ **生产环境使用建议**:

1. **密钥管理**：使用安全的密钥管理系统，不要硬编码密钥
2. **密钥轮换**：定期更换密钥，实施密钥轮换策略
3. **传输安全**：虽然项目支持HTTP环境，但生产环境建议使用HTTPS
4. **访问控制**：添加身份验证和授权机制
5. **速率限制**：防止暴力破解攻击
6. **日志审计**：记录敏感操作日志

这个演示项目仅用于学习和测试AES加密解密流程，请勿在生产环境中直接使用。
